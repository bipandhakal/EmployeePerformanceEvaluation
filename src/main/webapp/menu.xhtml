<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets">

    <h:form id="menu_form">
        <p:menubar style="background-color: #9BC6EA;">
            <p:menuitem value="Home" icon="pi pi-home" outcome="index.xhtml?faces-redirect=true"/>
            <p:menuitem  value="Employee" outcome="employee.xhtml?faces-redirect=true" rendered="#{userBean.admin}"/>
            <p:menuitem value="Category" outcome="category.xhtml?faces-redirect=true" rendered="#{userBean.admin}"/>
            <p:submenu label ="Criteria">
                <p:menuitem value="Create Criteria" outcome="criteria.xhtml?faces-redirect=true"
                            rendered="#{userBean.admin}"/>
                <p:submenu label="Calculated By">
                    <p:menuitem value="Criteria Range" outcome="criteriaRange.xhtml?faces-redirect=true"
                                rendered="#{userBean.admin}"/>
                    <p:menuitem value="Criteria Self" outcome="criteriaSelf.xhtml?faces-redirect=true"
                                rendered="#{userBean.employee}"/>
                    <p:menuitem value="Criteria TrueFalse" outcome="criteriaTrueFalse.xhtml?faces-redirect=true"
                                rendered="#{userBean.admin}"/>
                </p:submenu>
            </p:submenu>
            <p:menuitem  value="Employee Achievements" outcome="employeeAchievements.xhtml?faces-redirect=true"
                         rendered="#{userBean.employee}" />
            <p:menuitem  value="Supervisor Evaluation" outcome="supervisorEvaluation.xhtml?faces-redirect=true"
                         rendered="#{userBean.admin}"/>
            <p:menuitem value="Monthly Report" outcome="monthlyReport.xhtml?faces-redirect=true"/>
            <p:menuitem value="Annual Report" outcome="annualReport.xhtml?faces-redirect=true"/>
            <p:menuitem value="Register" oncomplete="PF('rdialog').show();" update="@this :frm_user_create" process="@this"
                        icon="pi pi-user-plus" style="position: relative; left: 14rem;"
                        rendered="#{userBean.user.role eq 'admin'}" actionListener="#{userController.beforeCreate()}"/>
            <f:facet name="options">
                <p:outputLabel value="Welcome, #{userBean.user.username}" rendered="#{userBean.loggedIn}" 
                               style="position: relative; right: 20px; top: 10px;"/>
            </f:facet>
            <f:facet name="options">
                <p:commandButton id ="btn_logout" action="#{userController.logout()}" style="float: right;"
                                 icon="pi pi-sign-out" title="Log Out">
                    <p:confirm header="Confirmation" message="Are you sure you want to log out?"/>
                </p:commandButton>
            </f:facet>
        </p:menubar>
        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade" responsive="true" width="350">
            <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no ui-button-flat"/>
            <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes"/>
        </p:confirmDialog>
    </h:form>

    <p:dialog header="Enter user details" widgetVar="rdialog" id="dlog_user">
        <h:form id="frm_user_create">
            <h:panelGrid columns ="3" styleClass="ui-panelgrid">

                <p:outputLabel id="olbl_role" value = "Role"/>
                <p:selectOneMenu id="som_role" value="#{userController.user.role}">
                    <f:selectItem itemLabel="Select One" itemValue=""/>
                    <f:selectItem itemLabel="admin" itemValue="admin"/>
                    <f:selectItem itemLabel="employee" itemValue="employee"/>
                </p:selectOneMenu>
                <br></br>

                <p:outputLabel id="olbl_uname" value = "UserName"/>
                <p:inputText id = "intxt_uname" value="#{userController.user.username}" 
                             label="UserName" title="UserName" 
                             required="true" requiredMessage="UserName is required">
                    <p:ajax event="blur"  update="@this errmsg_uname olbl_uname"  process="@this" />
                </p:inputText>
                <p:message for="intxt_uname" id="errmsg_uname"  style="color: red"/>

                <p:outputLabel id="olbl_pass" value = "Password"/>
                <p:password id="inp_pass" value="#{userController.user.password}" toggleMask="true" redisplay="true"
                            required="true" requiredMessage="Password is required" label="Password" title="Password">
                    <p:ajax event="blur"  update="@this errmsg_pass olbl_pass"  process="@this" />
                </p:password>
                <p:message for="inp_pass" id="errmsg_pass"  style="color: red"/>
            </h:panelGrid>
            <p:divider/>
            <h:panelGrid columns="1">
                <p:commandButton id = "register_usr" value ="Register" ajax="false" action="#{userController.create()}"/>
            </h:panelGrid>
        </h:form>
    </p:dialog>
</ui:composition>